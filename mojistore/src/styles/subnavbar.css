/* ==========================================================================
   MojiStore — SubNavbar (dropdown list: boxes, up to 3 cols, no inner scroll)
   ========================================================================== */

.ms-subnav{
  position: relative;
  z-index: var(--z-subnav);
  width: 100%;
  background: var(--color-bg);
  border-bottom: 1px solid var(--color-border);
  backdrop-filter: blur(10px) saturate(120%);
  /* absolutely-positioned menus can’t create sideways scroll */
  overflow-x: clip;
  overflow-y: visible;
}

.ms-subnav .row{
  display:flex;
  flex-wrap:wrap;
  gap:.6rem;
  padding:.55rem 0;                 /* slimmer row */
  align-items:center;
  position:relative;
}

.ms-subnav .ms-cat{ position:relative; display:inline-block; }

/* Pill */
.ms-subnav .ms-pill{
  display:inline-flex; align-items:center; white-space:nowrap;
  border:1px solid var(--color-border);
  background:var(--color-surface);
  color:var(--color-text);
  padding:.42rem .8rem;              /* sleeker pill */
  border-radius:var(--r-btn);
  font-size:.9rem;
  text-decoration:none;
  transition: border-color .15s ease, background-color .15s ease, color .15s ease, transform .15s ease;
}
.ms-subnav .ms-pill:hover{
  transform: translateY(-1px);
  border-color: color-mix(in oklab, var(--color-border) 60%, var(--color-accent));
  background: var(--color-surface-2);
}

/* Active pill (when on /products?category=ID) */
.ms-subnav .ms-pill.is-active,
.ms-subnav .ms-pill[aria-current="page"]{
  border-color: var(--color-accent);
  background: color-mix(in oklab, var(--color-surface) 75%, var(--color-accent));
  color: var(--color-text);
}

/* Dropdown anchor (directly below) */
.ms-subnav .ms-mega{
  position:absolute;
  top: calc(100% + 6px); /* no gap → no flicker */
  left:0;                /* default: align under start of pill */
  display:none;
  z-index: var(--z-dropdown);
  pointer-events:none;
  max-width: 100vw;
}

/* Hover bridge to keep :hover alive while moving to menu */
.ms-subnav .ms-mega::before{
  content:"";
  position:absolute;
  left:0; right:0; top:-8px;
  height:8px;
}

/* Open states */
.ms-subnav .ms-cat:hover > .ms-mega,
.ms-subnav .ms-cat:focus-within > .ms-mega,
.ms-subnav .ms-cat[data-open="1"] > .ms-mega,
.ms-subnav .ms-mega.is-open{
  display:block !important;
  pointer-events:auto;
}

/* Alignment control (toggled by JS to avoid right overflow) */
.ms-subnav .ms-mega[data-align="end"]{ left:auto; right:0; }
.ms-subnav .ms-mega[data-align="center"]{ left:50%; transform: translateX(-50%); }

/* Menu card — width derives from column count; no inner scrollbar */
.ms-subnav .ms-mega-card{
  --cols: 1;                          /* JS sets 1..3 */
  --rows: 7;                          /* JS bumps if > 21 items */
  --col-min: 210px;
  --gap-x: 12px;
  --gap-y: 8px;

  inline-size: fit-content;           /* shrink to fit content */
  min-inline-size: calc(var(--cols) * var(--col-min) + (var(--cols) - 1) * var(--gap-x));
  max-inline-size: min(96vw, calc(var(--cols) * 280px + (var(--cols) - 1) * var(--gap-x)));
  /* no max-height and no overflow → no inner scrollbar */
  overflow: visible;

  padding:.75rem;
  background:var(--color-surface);
  border:1px solid var(--color-border);
  border-radius:var(--r-card);
  box-shadow: var(--shadow-1);
  will-change: transform, opacity;
  animation: msMegaIn .14s ease-out both;
}

/* Title */
.ms-subnav .ms-mega-title{
  font-size:.72rem; font-weight:700; letter-spacing:.08em;
  color:var(--color-muted);
  padding:.2rem .25rem .55rem;
}

/* List grid: fill down first, then across; max 3 columns */
.ms-subnav .ms-mega-grid{
  display:grid;
  grid-auto-flow: column;  /* fill rows first */
  grid-template-rows: repeat(var(--rows), auto);
  grid-template-columns: repeat(var(--cols), minmax(var(--col-min), 1fr));
  gap: var(--gap-y) var(--gap-x);
  align-items:start;
}

/* Item boxes (boxed even without hover) */
.ms-subnav .ms-mega-item{
  display:block;
  padding:.55rem .7rem;
  border-radius:12px;
  border:1px solid var(--color-border);
  background: var(--color-surface-2);
  color:var(--color-text);
  text-decoration:none;
  transition: background-color .12s ease, border-color .12s ease, color .12s ease, transform .12s ease;
}
.ms-subnav .ms-mega-item:hover,
.ms-subnav .ms-mega-item:focus{
  background: color-mix(in oklab, var(--color-surface-2) 70%, var(--color-accent));
  border-color: var(--color-accent);
  transform: translateY(-1px);
  outline:none;
}

/* Subtle intro */
@keyframes msMegaIn{
  from{ opacity:0; transform: translateY(-6px) scale(.985); }
  to{   opacity:1; transform: translateY(0)    scale(1); }
}
@media (prefers-reduced-motion: reduce){
  .ms-subnav .ms-mega-card{ animation:none; }
}
